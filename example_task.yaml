name: example-training-job
num_nodes: 2

resources:
  cpus: "2"
  memory: "4Gi"
  #accelerators: H200:1
  image_id: "python:3.11-slim"

envs:
  BATCH_SIZE: "32"
  EPOCHS: "10"
  MODEL_NAME: "resnet50"

# Optional: Mount volumes into the task container
# Create volumes first using: k8s-cli volume create <name> <size>
# Syntax: volumes maps mount_path to volume_name
#volumes:
#  /data: training-data
#  /checkpoints: model-checkpoints

setup: |
  pip install numpy pandas
  echo "Setup completed"

run: |
  echo "Starting training with batch size: $BATCH_SIZE"
  echo "Running for $EPOCHS epochs"
  echo "Node rank: $NODE_RANK / Total nodes: $NUM_NODES"
  python -c "import os; print(f'Training job executed successfully on node {os.getenv(\"NODE_RANK\")}/{os.getenv(\"NUM_NODES\")}')"
